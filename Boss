using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CSlight
{
    class Program
    {
        static void Main(string[] args)
        {
            const string Spell1 = "Фаербол";
            const string Spell2 = "Звездопад";
            const string Spell3 = "Зазеркалье";
            const string Spell4 = "Ядовитая инверсия";

            int playerHealth = 700;
            int minDamageSpell1 = 75;
            int maxDamageSpell1 = 150;
            Random randomDamageSpell1 = new Random();
            int damageSpell1;
            int minDamageSpell2 = 150;
            int maxDamageSpell2 = 190;
            Random randomDamageSpell2 = new Random();
            int damageSpell2;
            int minHealthSpell3 = 80;
            int maxHealthSpell3 = 120;
            Random randomHealthSpell3 = new Random();
            int healthSpell3;
            int minDamageSpell4 = 80;
            int maxDamageSpell4 = 120;
            Random randomDamageSpell4 = new Random();
            int damageSpell4;
            string previousSpell = "";
            string playerCommand = "";
            bool inversionIsOn = false;
            int counterInversion = 0;
            int minEnemyHealth = 900;
            int maxEnemyHealth = 1500;
            int minEnemyDamage = 25;
            int maxEnemyDamage = 150;
            int deadLine = 0;
            Random randonEnemyHealth = new Random();
            Random randomEnemyDamage = new Random();
            int enemyHealth = randonEnemyHealth.Next(minEnemyHealth,maxEnemyHealth);
            int enemyDamage;


            Console.WriteLine($"Приветствую тебя Темный Маг, тебе предстоит битва с Орком Людоедом.\n" +
                $"У тебя {playerHealth} жизней.\n" +
                $"Ты владеешь 4-мя заклинаниями:\n" +
                $"\"Фаербол\" - Огненый шар который наносит от {minDamageSpell1} до {maxDamageSpell1} урона \n" +
                $"\"Звездопад\" - Огромные осколки метеорита падают на врага. Можно использовать только после заклинания \"Фаербол\", наносит от {minDamageSpell2} до {maxDamageSpell2} урона.\n" +
                $"\"Зазеркалье\" - Ты спользуешь магию своего зеркального амулета и создаешь свою зеркальную копию," +
                $" в то время когда враг атакует твою копию, ты восстанавливаешь свои жизни. Заклинание востанавливает от {minHealthSpell3} до {maxHealthSpell3} жизней.\n" +
                $"\"Ядовитая инверсия\" - Это заклинание можно спользовать только после заклинания \"Зазеркалье\". Ты наносишь врагу урон от {minDamageSpell4} до {maxDamageSpell4}, так же враг получает дополнительный урон в течении 5 ходов," +
                $" и ты так же получаешь урон от {minDamageSpell4} до {maxDamageSpell4}.");

            while ( playerHealth> deadLine && enemyHealth > deadLine)
            {
                Console.WriteLine("Какое заклинание ты будешь колдовать?");
                playerCommand = Console.ReadLine();

                switch (playerCommand)
                {
                    case Spell1:
                        damageSpell1 = randomDamageSpell1.Next(minDamageSpell1, maxDamageSpell1);
                        enemyHealth -= damageSpell1;
                        Console.WriteLine($"{Spell1} нанес {damageSpell1} урона, у Орка осталось {enemyHealth} жизней.");
                        previousSpell = Spell1;
                        break;
                    case Spell2:
                        if(previousSpell == Spell1)
                        {
                            damageSpell2 = randomDamageSpell2.Next(minDamageSpell2, maxDamageSpell2);
                            enemyHealth -= damageSpell2;
                            Console.WriteLine($"{Spell2} нанес {damageSpell2} урона, у Орка осталось {enemyHealth} жизней.");
                            previousSpell = Spell2;
                            break;
                        }
                        else
                        {
                            Console.WriteLine($"Ты пытаешься вызвать {Spell2}, но терпишь неудачу," +
                                $" так как ты в прошлый раз колдовал не {Spell1}.");
                        }
                        break;
                    case Spell3:
                        healthSpell3 = randomHealthSpell3.Next(minHealthSpell3, maxHealthSpell3);
                        playerHealth += healthSpell3;
                        Console.WriteLine($"Ты восстанавливаешь {healthSpell3} жизней, всего у тебя {playerHealth} жизней.");
                        previousSpell = Spell3;
                        break;
                    case Spell4:
                        if (previousSpell == Spell3)
                        {
                            damageSpell4 = randomDamageSpell4.Next(minDamageSpell4, maxDamageSpell4);
                            enemyHealth -= damageSpell4;
                            playerHealth -= damageSpell4;
                            Console.WriteLine($"{Spell4} нанесла {damageSpell4} урона тебе и Орку. У Орка осталось {enemyHealth} жизней, у тебя - {playerHealth}.");
                            previousSpell = Spell4;
                            inversionIsOn = true;
                            counterInversion = 0;
                            break;
                        }
                        else
                        {
                            Console.WriteLine($"Ты пытаешься наложить заклинание {Spell4}, но терпишь неудачу," +
                                $" так как ты в прошлый раз колдовал не {Spell3}.");
                        }
                        break;
                }

                enemyDamage = randomEnemyDamage.Next(minEnemyDamage, maxEnemyDamage);
                playerHealth -= enemyDamage;
                Console.WriteLine($"Орк наносит тебе {enemyDamage} урона, у тебя осталось {playerHealth} жизней.");

                if (inversionIsOn && counterInversion <= 5)
                {
                    counterInversion++;
                    damageSpell4 = randomDamageSpell4.Next(minDamageSpell4, maxDamageSpell4);
                    enemyHealth -= damageSpell4;
                    Console.WriteLine($"Орк получает {damageSpell4} урона от заклинания {Spell4}. У Орка {enemyHealth} жизней.");
                }

                if (enemyHealth <= 0 && playerHealth <= 0)
                {
                    Console.WriteLine($"Вы дрались не на жизнь, а на смерть. Ничья.");
                }
                else if (enemyHealth <= 0)
                {
                    Console.WriteLine($"Ты победил! У тебя осталось {playerHealth} жизней.");
                }
                else if (playerHealth <= 0)
                {
                    Console.WriteLine($"Ты проиграл! У Орка осталось {enemyHealth} жизней.");
                }
            }
            Console.ReadKey();
        }
    }
}
